<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIC MIND - Last Card</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="app">
        <!-- Particles Background -->
        <div id="particles"></div>

        <!-- Lobby Screen -->
        <div id="lobby" class="screen active">
            <div class="lobby-container">
                <div class="logo-section">
                    <h1 class="game-title">MIC MIND</h1>
                    <p class="subtitle">Last Card / Crazy Eights</p>
                </div>

                <div class="lobby-section glass-panel" id="join-section">
                    <h2>Play Last Card</h2>
                    <div class="input-group">
                        <input type="text" id="player-name" placeholder="Enter Your Name" maxlength="15">
                        <div class="avatar-selector">
                            <label>Choose Avatar:</label>
                            <div class="avatar-options" id="avatar-options">
                                <div class="avatar-option selected" data-avatar="player1">&#128100;</div>
                                <div class="avatar-option" data-avatar="player2">&#128526;</div>
                                <div class="avatar-option" data-avatar="player3">&#129312;</div>
                                <div class="avatar-option" data-avatar="player4">&#128640;</div>
                                <div class="avatar-option" data-avatar="player5">&#127775;</div>
                                <div class="avatar-option" data-avatar="player6">&#128142;</div>
                            </div>
                        </div>
                    </div>

                    <div class="room-options">
                        <button id="create-room-btn" class="btn btn-primary btn-glow">
                            <span>&#127968; Create Room</span>
                        </button>
                        <div class="divider-text">or join existing room</div>
                        <div class="join-room-row">
                            <input type="text" id="room-id" placeholder="Enter Room Code" maxlength="6" style="text-transform: uppercase;">
                            <button id="join-btn" class="btn btn-secondary">
                                <span>Join</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="lobby-section glass-panel" id="player-setup" style="display: none;">
                    <h2>Game Lobby</h2>

                    <!-- Room Code Display -->
                    <div class="room-code-section">
                        <div class="room-code-label">Invite Friends to Join</div>
                        <div class="room-code-display">
                            <span id="room-code-value">------</span>
                            <button id="copy-room-code" class="btn btn-small btn-primary" title="Copy to clipboard">&#128203; Copy Code</button>
                        </div>
                        <div class="share-link-section">
                            <div class="share-link-label">Or share this link:</div>
                            <div class="share-link-display">
                                <input type="text" id="share-link-input" class="share-link-input" readonly>
                                <button id="copy-share-link" class="btn btn-small btn-secondary" title="Copy link">&#128279; Copy Link</button>
                            </div>
                        </div>
                    </div>

                    <div class="players-section">
                        <h3>Players <span id="player-count-badge">(0/8)</span></h3>
                        <div class="players-grid" id="players-list"></div>
                    </div>

                    <div class="add-ai-section" id="add-ai-section">
                        <h3>Add AI Opponents</h3>
                        <div class="ai-options">
                            <select id="ai-difficulty">
                                <option value="easy">Easy Bot</option>
                                <option value="medium" selected>Medium Bot</option>
                                <option value="hard">Hard Bot</option>
                            </select>
                            <button id="add-ai-btn" class="btn btn-secondary">
                                <span>+ Add Bot</span>
                            </button>
                        </div>
                    </div>

                    <div class="lobby-actions">
                        <button id="leave-room-btn" class="btn btn-danger">
                            <span>Leave Room</span>
                        </button>
                        <button id="start-game-btn" class="btn btn-success btn-glow btn-large" disabled>
                            <span>Start Game</span>
                            <small id="player-count-text">Need 2+ players</small>
                        </button>
                    </div>

                    <div id="waiting-for-host" class="waiting-for-host" style="display: none;">
                        <span>&#9203; Waiting for host to start the game...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game" class="screen">
            <!-- Top Bar -->
            <div class="top-bar">
                <div class="game-info">
                    <span class="game-title-small">&#127183; Last Card</span>
                    <span id="direction-indicator" class="direction-indicator">&#8635; Clockwise</span>
                    <span id="pending-draw-indicator" class="pending-draw" style="display: none;">
                        &#9888; Draw <span id="pending-draw-count">0</span> cards!
                    </span>
                </div>
                <div class="top-actions">
                    <button id="sound-toggle" class="icon-btn" title="Toggle Sound">&#128266;</button>
                    <button id="help-btn" class="icon-btn" title="Game Rules">&#128161;</button>
                </div>
            </div>

            <!-- Main Game Area -->
            <div class="game-layout">
                <!-- Game Table -->
                <div class="poker-table-wrapper">
                    <div class="poker-table">
                        <div class="table-pattern"></div>

                        <!-- Players around table -->
                        <div id="seat-0" class="player-seat seat-0"></div>
                        <div id="seat-1" class="player-seat seat-1"></div>
                        <div id="seat-2" class="player-seat seat-2"></div>
                        <div id="seat-3" class="player-seat seat-3"></div>
                        <div id="seat-4" class="player-seat seat-4"></div>
                        <div id="seat-5" class="player-seat seat-5"></div>
                        <div id="seat-6" class="player-seat seat-6"></div>
                        <div id="seat-7" class="player-seat seat-7"></div>

                        <!-- Center Area - Discard & Draw Piles -->
                        <div class="table-center">
                            <div class="piles-container">
                                <div class="draw-pile">
                                    <div class="pile-label">Draw Pile</div>
                                    <div class="card card-back">
                                        <span id="draw-pile-count">52</span>
                                    </div>
                                </div>
                                <div class="discard-pile">
                                    <div class="pile-label">Discard</div>
                                    <div id="discard-card" class="card"></div>
                                    <div id="current-suit-indicator" class="suit-indicator"></div>
                                </div>
                            </div>
                            <div id="game-phase" class="phase-badge"></div>
                        </div>
                    </div>
                </div>

                <!-- Right Panel -->
                <div class="side-panel">
                    <!-- Players in Game -->
                    <div class="panel-section glass-panel players-panel">
                        <h3>&#128101; Players</h3>
                        <div id="game-players-list" class="game-players-list"></div>
                    </div>

                    <!-- Game Rules -->
                    <div class="panel-section glass-panel rules-panel">
                        <h3>&#127183; Game Rules</h3>
                        <div class="rules-list">
                            <div class="rule-item"><span class="rule-card">Any</span><span class="rule-desc">Match rank OR suit</span></div>
                            <div class="rule-item"><span class="rule-card">8</span><span class="rule-desc">Wild - Choose any suit</span></div>
                            <div class="rule-item"><span class="rule-card">2</span><span class="rule-desc">Next player draws 2</span></div>
                            <div class="rule-item"><span class="rule-card">A</span><span class="rule-desc">Reverse direction</span></div>
                            <div class="rule-item"><span class="rule-card">J</span><span class="rule-desc">Skip next player</span></div>
                        </div>
                    </div>

                    <!-- Chat -->
                    <div class="panel-section glass-panel chat-panel">
                        <h3>Chat</h3>
                        <div class="chat-messages" id="chat-messages"></div>
                        <div class="chat-input-area">
                            <div class="emoji-bar">
                                <button class="emoji-btn" data-emoji="&#128077;">&#128077;</button>
                                <button class="emoji-btn" data-emoji="&#128078;">&#128078;</button>
                                <button class="emoji-btn" data-emoji="&#128293;">&#128293;</button>
                                <button class="emoji-btn" data-emoji="&#128514;">&#128514;</button>
                            </div>
                            <div class="chat-input-row">
                                <input type="text" id="chat-input" placeholder="Type message..." maxlength="200">
                                <button id="send-chat" class="btn btn-small">Send</button>
                            </div>
                        </div>
                    </div>

                    <!-- Action Log -->
                    <div class="panel-section glass-panel">
                        <h3>Game Log</h3>
                        <ul id="action-log-list" class="action-log-list"></ul>
                    </div>
                </div>
            </div>

            <!-- Bottom Area - My Cards & Actions -->
            <div class="bottom-area">
                <!-- My Hand -->
                <div class="my-hand-section glass-panel">
                    <div class="my-hand-label">Your Hand (<span id="my-card-count">0</span> cards)</div>
                    <div id="my-cards" class="my-cards"></div>
                </div>

                <!-- Action Panel -->
                <div id="action-panel" class="action-panel glass-panel">
                    <div class="action-buttons" id="action-buttons">
                        <button id="draw-btn" class="action-btn draw-btn">
                            <span class="btn-icon">&#127183;</span>
                            <span class="btn-text">Draw Card</span>
                            <span class="hotkey">[D]</span>
                        </button>
                        <button id="play-btn" class="action-btn play-btn" disabled>
                            <span class="btn-icon">&#9654;</span>
                            <span class="btn-text">Play Card</span>
                            <span class="hotkey">[Space]</span>
                        </button>
                        <button id="lastcard-btn" class="action-btn lastcard-btn" style="display: none;">
                            <span class="btn-icon">&#128227;</span>
                            <span class="btn-text">Last Card!</span>
                            <span class="hotkey">[L]</span>
                        </button>
                    </div>

                    <div id="waiting-message" class="waiting-message" style="display: none;">
                        <div class="waiting-spinner"></div>
                        <span>Waiting for <strong id="current-player-name"></strong></span>
                    </div>
                </div>

                <!-- Game Over Panel -->
                <div id="game-over-panel" class="hand-complete-panel glass-panel" style="display: none;">
                    <div class="winner-announcement">
                        <div class="winner-trophy">&#127942;</div>
                        <div id="winner-message" class="winner-message"></div>
                    </div>
                    <button id="new-round-btn" class="btn btn-success btn-glow btn-large">
                        <span>&#127183; Play Again</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Suit Selector Modal -->
        <div id="suit-modal" class="modal" style="display: none;">
            <div class="modal-content glass-panel suit-selector">
                <h3>Choose a Suit</h3>
                <div class="suit-options">
                    <button class="suit-btn" data-suit="hearts"><span class="suit-hearts">&#9829;</span> Hearts</button>
                    <button class="suit-btn" data-suit="diamonds"><span class="suit-diamonds">&#9830;</span> Diamonds</button>
                    <button class="suit-btn" data-suit="clubs"><span class="suit-clubs">&#9827;</span> Clubs</button>
                    <button class="suit-btn" data-suit="spades"><span class="suit-spades">&#9824;</span> Spades</button>
                </div>
            </div>
        </div>

        <!-- Floating Emojis Container -->
        <div id="floating-emojis"></div>

        <!-- Notification Toast -->
        <div id="notification-toast" class="notification-toast" style="display: none;"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.min.js"></script>
    <script src="/static/js/game.js"></script>
</body>
</html>
